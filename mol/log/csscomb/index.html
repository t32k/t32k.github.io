<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="fb:app_id" content="212646065416408">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="MOL">
        <title>CSScomb &middot; MOL</title>
        <link rel="stylesheet" href="http://localhost:1313/mol/css/skeleton.css">
        <link rel="publisher" href="//plus.google.com/+kojiishimoto">
        <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Sans:400,700">
        <link rel="alternate" href="" type="application/rss+xml" title="MOL">
    </head>
    <body role="document">
    <div class="container">
<header class="site-header">
  <nav>
    <a href="/mol/">Blog</a>
    <a href="/">About</a>
    <a href="https://github.com/t32k/feedback/issues/new">Questions</a>
  </nav>
</header>

    <article class="post">
        <header class="post-header">
            <p class="t-hint">By Koji Ishimoto — <time>Wednesday, October 17, 2012</time></p>
            <h1 class="post-h1 m-0">CSScomb</h1>
            <h4 class="t-hint"></h4>
        </header>
        <section>
            <p><p style="text-align: center;"><a href="http://csscomb.com/"><img class="aligncenter size-full fig" title="csscomb" src="/static/blog/2012/10/csscomb.jpg" alt="" width="520" height="260" /></a></p>
うららかに晴れた秋の日、みなさんいかがお過ごしか？こんちわ @t32k だ。</p>

<p>今日は<strong><a href="http://csscomb.com/">CSScomb</a></strong>ってツールの紹介だよ。タネマキであった<a href="https://twitter.com/cipher">こもりさん</a>のSublime Text2勉強会のときに知ったんだけど、 まぁ、CSSプロパティを綺麗にソートしてくれるって代物だ。大まかな機能はこんな感じ。
<ul>
    <li>CSSプロパティのソート</li>
    <li>ソート順は設定可能</li>
    <li>&lt;style&gt;タグ、style属性もパースできる</li>
    <li>スタイルシートのフォーマットは変更しない(ホワイトスペースの除去とかしない)</li>
    <li>CSS2,3,4も完全にサポートしてる</li>
</ul>
<a href="http://csscomb.com/online/">オンライン</a>でも使えるし、Sublime Textだけじゃなくてメジャーなテキストエディタだったら、たいてい<a href="https://github.com/miripiruni/CSScomb/downloads/">プラグインが用意</a>されてるんだ。</p>

<p>へー便利なものがあるなーと思ったけども、<a href="https://twitter.com/t32k/statuses/224069764396498944">Sassファイルでこのツールを実行するとそんときはバグってて</a>、単純にプロパティ順を綺麗にさせるためだけなのに、そんな致命的なバグの危険性（CSSが壊れる）とかマジ勘弁！などと思ったけど、あれから3ヶ月、俺もCSScombも成長したんだ。その話を聞いてくれ。
<h2>SassとCSScomb</h2>
まずは、Sass文法をうまく理解していなかった点。<a href="http://csscomb.com/tests/">Tests</a> を見てくれ。見てごらん綺麗な緑色してんだろ。これテストに合格してるんだぜ&hellip;ってことで、Sass関連のテストも今じゃパスしてる様子。@includeが消えたりするバグも僕の方でも確認できていない。YOSHI 合格だ。</p>

<p>ちょっとReal Filesでwarningがあるみたいだけど、Sassのパーシャルファイルとか見通しのよいファイル単位でCSScombしてあげれば問題があってもすぐ気づけるからまぁそこまでも気にしなくてもいいかなと思ってる。働いたら負けかなと思ってる。
<h2>gzipとCSScomb</h2>
次に、CSSプロパティのソートは自己満足か？ってこと。基本コードは綺麗なほうがいいに決まってるけどそれがユーザーに対してなんかしらのメリットがないと、どーも後押しが弱いなって感じです。順番ぐらいそこまでひどくない限り、特に問題になることもないと思う（よっぽど書き散らかしたときは別だけど）。そう思ってた時代も僕にはありました。
<ul>
    <li><strong><a href="http://t32k.github.com/speed/articles/gzip.html">gzip圧縮のしくみ | LPWS </a></strong></li>
</ul>
まずは↑こちらをご覧いただきたい。gzipってテキストファイルとかを圧縮する技術なんですが、これサーバー側の設定をちょいちょいとするだけの割りにはなかなかナイスーな効果を発揮してくれるパフォーマンス対策のひとつでもあります。これの仕組みなんですけど、要は同じような文字列を探してひとまとめとして考えるみたいなんですね。参照リンクの例ではそれぞれ別のhnタグと全部同じのdivタグの場合だと未圧縮の状態ではhnタグのほうが少ないバイト数ですが、gzip圧縮するとdivタグのほうが少ないバイト数になるんですね。divのまとまりがひとつとしてみなされてるみたいな感じですかね。</p>

<p>これはHTMLの例ですが、CSSの場合も同じような文字列がでてきますよね。たいていどのセレクタもmarginとかpaddingとかwidthとか含んでいます。こーいったプロパティの順番がセレクタごとにバラバラだったら同じような文字列としてカウントされないのでgzip圧縮効率も悪いんじゃねーの？って話です。</p>

<p>試しに、Apple Storeのbase.cssで実験してみましょう。別にApple StoreのCSSが汚いって言ってるわけじゃなくてある程度分量があったから良いサンプルかなと思ったのです。
<ul>
    <li><a href="http://store.storeimages.cdn-apple.com/6487/store.apple.com/rs/rel/base.css">http://store.storeimages.cdn-apple.com/6487/store.apple.com/rs/rel/base.css</a></li>
</ul>
<p style="text-align: center;"><a href="/static/blog/2012/10/b4.png"><img class="aligncenter  wp-image-4376" title="b4" src="/static/blog/2012/10/b4.png" alt="" width="520" /></a></p>
んで、素のbase.cssとCSScombをかけた奴。もともとminifyされてるから綺麗になったかどうかわかんないけど多分ソートされたのでしょう。なぜかCombしたほうがファイルサイズが大きくなってますが、重要なのはgzipされた状態でのサイズです。
<p style="text-align: center;"><a href="/static/blog/2012/10/a5.png"><img class="aligncenter  wp-image-4377" title="a5" src="/static/blog/2012/10/a5.png" alt="" width="500" /></a></p>
はい、これをgzipコマンドにかけてみるとどーでしょう！わお、400バイトほど軽くなってるじゃないですか！うそーまじー！！</p>

<p>はい。</p>

<p>gzip圧縮を想定してない場合意味ないとか、たった400バイトとか&hellip;そういった意見もあるかもしれないけど、ボタン1発でできるのならやったほうがいいよねと僕は思います。別に毎回やる必要もないし、ほんとデプロイの時に最後のひと手間かけてやるだけなんでみなさんもどーですかね。まさしくお出かけ前のCombですね！！</p>

        </section>
    </article>

    <div class="post-social">
    <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
    <div class="fb-like" data-width="150" data-layout="button_count" data-action="like" data-show-faces="true" data-send="false"></div>
    <div class="g-plusone" data-size="medium"></div>
</div>

<div class="u-cf" style="padding:2rem 0; border-radius: 1rem">
    <p class="u-pull-left"><img src="/mol/images/t32k.png" width="64" height="64" alt></p>
    <p style="margin-left: 80px">Written by <strong>Koji Ishimoto</strong>, Web Developer in Vancouver.<br>
        <a href="http://cloud.feedly.com/#subscription%2Ffeed%2Fhttp%3A%2F%2Ft32k.me%2Fmol%2Ffeed.xml" target="blank">
            <img src="http://s3.feedly.com/img/follows/feedly-follow-circle-flat-green_2x.png" width="20" height="20" alt style="vertical-align: middle"> Subscribe on feedly.</a>
    </p>
</div>

<hr>

    <div class="row li-pagination">
        <div class="six columns">
            <div class="li-pagination-previous">
                
                    Later article<br>
                    <a href="http://localhost:1313/mol/log/csso-and-grunt-csso/"> CSSOとgrunt-csso</a>
                
            </div>
        </div>
        <div class="six columns">
            <div class="li-pagination-next">
                
                    Older article<br>
                    <a href="http://localhost:1313/mol/log/defer-parsing-of-google-analytics/"> Google Analytics トラッキングスニペット再考（2012年モバイル版）</a>
                
            </div>
        </div>
    </div>

<hr>

<section>
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-1326877318485833"
       data-ad-slot="7307465775"
       data-ad-format="auto"></ins>
</section>

<hr>

<footer>
  <small roll="contentinfo">&copy; 2007 t32k.me</small>
</footer>
    <script>
        
        (function(d, s) {
            var js,
                fjs = d.getElementsByTagName(s)[0],
                load = function(url, id) {
                    if (d.getElementById(id)) {return;}
                    js = d.createElement(s); js.src = url; js.id = id;
                    fjs.parentNode.insertBefore(js, fjs);
                };
            load('//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=212646065416408&version=v2.0', 'fbjssdk');
            load('//platform.twitter.com/widgets.js', 'tweetjs');
            load('https://apis.google.com/js/plusone.js', 'gplusjs');
            load('//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js', 'adsense');
        }(document, 'script'));
        
        (adsbygoogle = window.adsbygoogle || []).push({});
        
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-2317436-26', 't32k.me');
        ga('send', 'pageview');
    </script>

    </div>
    <script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>